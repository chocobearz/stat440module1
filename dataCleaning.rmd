---
title: "Module1"
author: "Paige Tuttosi"
date: "25/09/2020"
output: html_document
---

```{r}
source('range_to_mean.R')
source('words_split.R')
library(ggplot2)
library(stringr)
library(purrr)
```

```{r}
# Load in the new training data
train <- read.csv("data/train2.txt")
```


```{r, eval = F}
summary(train)
str(train)
```

```{r}
# Clean age ranges by converting age ranges to a single number
train$clean_age <- map_dbl(train$age, range_to_mean)
summary(train)
str(train)
```



```{r}
ggplot(train, aes(x=clean_age, y=duration, color=sex)) +
  geom_point()
ggplot(train, aes(x=clean_age, y=duration, color=city)) +
  geom_point()
ggplot(train, aes(x=clean_age, y=duration, color=country)) +
  geom_point()
ggplot(train, aes(x=clean_age, y=duration, color=province)) +
  geom_point()
ggplot(train, aes(x=clean_age, y=duration, color=V1)) +
  geom_point()
ggplot(train, aes(x=clean_age, y=duration, color=outcome)) +
  geom_point()
```

Clean symptoms
```{r}
# Create a vector of symptoms, with each element corresponding to a symptom
words1 <- words_split(train1$symptoms, sep = "; ")

# Looking at the frequencies of the symptoms
sort(table(words1), decreasing = T)

# Get the unique symptoms
words2 <- unique(words1)
# Replace the "℃" with "C"
words2 <- str_replace_all(words2, "℃", "C")
# Replace " ° " with " "
words2 <- str_replace_all(words2, " ° ", " ")

# Initialize a dataframe
symptoms_df <- data.frame(matrix(nrow = nrow(train),
                                 ncol = length(words2)))
# Create column names from the unique symptoms
colnames(symptoms_df) <- words2

# Create the vectors for the columns
for( i in c( 1:length(words2) ) ){
  # Each column indicates if the word is present in the symptoms column
  symptoms_df[ , i] <- str_detect(train$symptoms, words2[i])
}

# Combine the original train1 data frame with the new symptoms data frame
train2 <- cbind(train, symptoms_df)
```






